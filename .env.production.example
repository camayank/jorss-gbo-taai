# =============================================================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# =============================================================================
#
# SECURITY WARNING: Never commit actual secrets to version control!
#
# QUICK START:
#   python3 scripts/generate_secrets.py --env > .env.production
#   Then fill in DATABASE_URL, REDIS_URL, OPENAI_API_KEY, and CORS_ORIGINS.
#
# VERIFY:
#   python3 scripts/generate_secrets.py --verify --env-file .env.production
#
# =============================================================================

# -----------------------------------------------------------------------------
# REQUIRED SECURITY SETTINGS (App will not start without these in production)
# -----------------------------------------------------------------------------

# Application environment - MUST be "production" or "staging" for production mode
APP_ENVIRONMENT=production
ENVIRONMENT=production

# Main application secret key (min 32 characters)
# Used for session signing, CSRF tokens, etc.
APP_SECRET_KEY=REPLACE_WITH_64_CHAR_HEX_STRING

# JWT signing key (min 32 characters)
# Used for authentication tokens
JWT_SECRET=REPLACE_WITH_64_CHAR_HEX_STRING

# Auth service secret (min 32 characters)
# Used for internal auth operations
AUTH_SECRET_KEY=REPLACE_WITH_64_CHAR_HEX_STRING

# Password hashing salt (min 16 characters)
# Used for password hashing - changing this invalidates all passwords!
PASSWORD_SALT=REPLACE_WITH_32_CHAR_HEX_STRING

# PII encryption master key (min 32 characters)
# Used for encrypting email, phone, SSN in database
# CRITICAL: Losing this key = losing access to encrypted data!
ENCRYPTION_MASTER_KEY=REPLACE_WITH_64_CHAR_HEX_STRING

# CSRF protection secret (min 32 characters)
# Used for CSRF token generation and validation
CSRF_SECRET_KEY=REPLACE_WITH_64_CHAR_HEX_STRING

# SSN hashing secret (min 32 characters)
# Used for HMAC-SHA256 hashing of SSNs
SSN_HASH_SECRET=REPLACE_WITH_64_CHAR_HEX_STRING

# Data serialization signing key (optional, auto-generated if missing)
SERIALIZER_SECRET_KEY=REPLACE_WITH_64_CHAR_HEX_STRING

# Audit log HMAC signature key (optional, auto-generated if missing)
AUDIT_HMAC_KEY=REPLACE_WITH_64_CHAR_HEX_STRING

# -----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# -----------------------------------------------------------------------------

# PostgreSQL connection (recommended for production)
DATABASE_URL=postgresql://user:password@localhost:5432/taxplatform

# Connection pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30

# -----------------------------------------------------------------------------
# REDIS CONFIGURATION
# -----------------------------------------------------------------------------

# Connection URL (preferred — use this for Upstash, Render, Heroku, etc.)
REDIS_URL=redis://:your_password@your-host:6379

# Or individual settings (used if REDIS_URL is not set)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=your_redis_password
# REDIS_SSL=false
# REDIS_DB=0

# Session storage type: "redis" (recommended) or "sqlite"
SESSION_STORAGE_TYPE=redis
SESSION_EXPIRY_HOURS=24
SESSION_TIMEOUT_MINUTES=30

# -----------------------------------------------------------------------------
# APPLICATION SETTINGS
# -----------------------------------------------------------------------------

# Application info
APP_NAME=Tax Platform
APP_VERSION=1.0.0
APP_DEBUG=false

# API settings
APP_API_HOST=0.0.0.0
APP_API_PORT=8000
APP_API_WORKERS=4

# HTTPS enforcement (should be true in production)
APP_ENFORCE_HTTPS=true

# Rate limiting
APP_ENABLE_RATE_LIMITING=true

# CORS origins (comma-separated, NO brackets)
CORS_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# OpenAI API key (required for AI filing/advisory features)
OPENAI_API_KEY=REPLACE_WITH_OPENAI_API_KEY

# Optional: additional AI providers for fallback chain
# ANTHROPIC_API_KEY=sk-ant-...
# GOOGLE_API_KEY=...
# PERPLEXITY_API_KEY=...

# AI feature flags
AI_CHAT_ENABLED=true
AI_SAFETY_CHECKS=true

# -----------------------------------------------------------------------------
# EMAIL CONFIGURATION (for notifications, password resets, reports)
# -----------------------------------------------------------------------------

# Option A: SendGrid API (recommended)
SENDGRID_API_KEY=REPLACE_WITH_SENDGRID_API_KEY
SENDGRID_FROM_EMAIL=noreply@yourdomain.com
SENDGRID_FROM_NAME=Tax Platform

# Option B: SMTP (fallback)
# SMTP_HOST=smtp.sendgrid.net
# SMTP_PORT=587
# SMTP_USERNAME=apikey
# SMTP_PASSWORD=your_sendgrid_api_key
# SMTP_FROM_EMAIL=noreply@yourdomain.com
# SMTP_USE_TLS=true

# -----------------------------------------------------------------------------
# CELERY CONFIGURATION (background tasks)
# -----------------------------------------------------------------------------

CELERY_BROKER_DB=1
CELERY_RESULT_DB=2

# -----------------------------------------------------------------------------
# MONITORING & LOGGING
# -----------------------------------------------------------------------------

# Sentry DSN for error tracking
SENTRY_DSN=https://your_sentry_dsn

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# FEATURE FLAGS
# -----------------------------------------------------------------------------

DB_PERSISTENCE=true
UNIFIED_FILING=true
APP_ENABLE_CACHING=true
APP_ENABLE_BACKGROUND_TASKS=true

# -----------------------------------------------------------------------------
# OAUTH (optional — for Google/Microsoft login)
# -----------------------------------------------------------------------------

# GOOGLE_CLIENT_ID=...
# GOOGLE_CLIENT_SECRET=...
# MICROSOFT_CLIENT_ID=...
# MICROSOFT_CLIENT_SECRET=...
# OAUTH_CALLBACK_URL=https://yourdomain.com

# -----------------------------------------------------------------------------
# PAYMENTS (optional — for CPA billing)
# -----------------------------------------------------------------------------

# STRIPE_SECRET_KEY=sk_live_...
# STRIPE_PUBLISHABLE_KEY=pk_live_...
# STRIPE_WEBHOOK_SECRET=whsec_...

# -----------------------------------------------------------------------------
# TAX CONFIGURATION
# -----------------------------------------------------------------------------

APP_DEFAULT_TAX_YEAR=2025

# =============================================================================
# SETUP INSTRUCTIONS
# =============================================================================
#
# 1. Generate all secrets at once:
#    python3 scripts/generate_secrets.py --env > .env.production
#
# 2. Fill in external service credentials:
#    - DATABASE_URL (Neon PostgreSQL recommended)
#    - REDIS_URL (Upstash recommended)
#    - OPENAI_API_KEY
#    - CORS_ORIGINS (your production domain)
#    - SENDGRID_API_KEY (for email)
#    - SENTRY_DSN (for error tracking)
#
# 3. Verify all secrets are valid:
#    python3 scripts/generate_secrets.py --verify --env-file .env.production
#
# 4. Test startup:
#    APP_ENVIRONMENT=production python3 scripts/preflight_launch.py
#
# See docs/PRODUCTION_LAUNCH_GUIDE.md for full deployment walkthrough.
# =============================================================================
