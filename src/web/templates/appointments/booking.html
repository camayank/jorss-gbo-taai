<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Appointment | JORSS-GBO</title>
    <link rel="stylesheet" href="/static/css/core/variables.css">
    <link rel="stylesheet" href="/static/css/core/reset.css">
    <link rel="stylesheet" href="/static/css/core/typography.css">
    <link rel="stylesheet" href="/static/css/unified-theme.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: var(--font-sans);
            background: var(--color-gray-50);
            min-height: 100vh;
            padding: var(--space-6);
        }

        .booking-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .booking-header {
            text-align: center;
            margin-bottom: var(--space-8);
        }

        .booking-title {
            font-size: var(--text-3xl);
            font-weight: var(--font-bold);
            color: var(--color-gray-900);
            margin-bottom: var(--space-2);
        }

        .booking-subtitle {
            font-size: var(--text-base);
            color: var(--color-gray-500);
        }

        .booking-card {
            background: white;
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }

        .booking-steps {
            display: flex;
            border-bottom: 1px solid var(--color-gray-200);
        }

        .step {
            flex: 1;
            padding: var(--space-4);
            text-align: center;
            position: relative;
            background: var(--color-gray-50);
        }

        .step.active {
            background: white;
        }

        .step.completed {
            background: var(--color-success-50);
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--color-gray-200);
            color: var(--color-gray-600);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: var(--font-semibold);
            margin-bottom: var(--space-2);
        }

        .step.active .step-number {
            background: var(--color-primary-600);
            color: white;
        }

        .step.completed .step-number {
            background: var(--color-success-500);
            color: white;
        }

        .step-title {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--color-gray-600);
        }

        .step.active .step-title {
            color: var(--color-primary-600);
        }

        .booking-content {
            padding: var(--space-6);
        }

        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
        }

        /* Appointment Type Selection */
        .type-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-4);
        }

        .type-card {
            padding: var(--space-5);
            border: 2px solid var(--color-gray-200);
            border-radius: var(--radius-xl);
            cursor: pointer;
            transition: all var(--transition-fast);
            text-align: center;
        }

        .type-card:hover {
            border-color: var(--color-primary-300);
            background: var(--color-primary-50);
        }

        .type-card.selected {
            border-color: var(--color-primary-500);
            background: var(--color-primary-50);
        }

        .type-icon {
            width: 56px;
            height: 56px;
            border-radius: var(--radius-lg);
            margin: 0 auto var(--space-3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .type-icon svg { width: 28px; height: 28px; }

        .type-icon.consultation { background: var(--color-primary-100); color: var(--color-primary-600); }
        .type-icon.review { background: var(--color-success-100); color: var(--color-success-600); }
        .type-icon.planning { background: var(--color-purple-100); color: var(--color-purple-600); }
        .type-icon.followup { background: var(--color-warning-100); color: var(--color-warning-600); }

        .type-name {
            font-size: var(--text-base);
            font-weight: var(--font-semibold);
            color: var(--color-gray-900);
            margin-bottom: var(--space-1);
        }

        .type-duration {
            font-size: var(--text-sm);
            color: var(--color-gray-500);
        }

        /* Date/Time Selection */
        .datetime-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-6);
        }

        .section-title {
            font-size: var(--text-lg);
            font-weight: var(--font-semibold);
            color: var(--color-gray-900);
            margin-bottom: var(--space-4);
        }

        .date-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: var(--space-2);
            margin-bottom: var(--space-4);
        }

        .date-header {
            text-align: center;
            font-size: var(--text-xs);
            font-weight: var(--font-semibold);
            color: var(--color-gray-500);
            padding: var(--space-2);
        }

        .date-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-lg);
            font-size: var(--text-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .date-cell:hover:not(.disabled) {
            background: var(--color-primary-100);
        }

        .date-cell.selected {
            background: var(--color-primary-600);
            color: white;
        }

        .date-cell.disabled {
            color: var(--color-gray-300);
            cursor: not-allowed;
        }

        .date-cell.today {
            font-weight: var(--font-bold);
            color: var(--color-primary-600);
        }

        .time-slots {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-2);
        }

        .time-slot {
            padding: var(--space-3);
            border: 1px solid var(--color-gray-200);
            border-radius: var(--radius-lg);
            text-align: center;
            font-size: var(--text-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .time-slot:hover:not(.disabled) {
            border-color: var(--color-primary-500);
            background: var(--color-primary-50);
        }

        .time-slot.selected {
            background: var(--color-primary-600);
            border-color: var(--color-primary-600);
            color: white;
        }

        .time-slot.disabled {
            background: var(--color-gray-50);
            color: var(--color-gray-400);
            cursor: not-allowed;
        }

        /* Confirmation Form */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-4);
        }

        .form-group {
            margin-bottom: var(--space-4);
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: block;
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--color-gray-700);
            margin-bottom: var(--space-2);
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: var(--space-3);
            border: 1px solid var(--color-gray-300);
            border-radius: var(--radius-lg);
            font-size: var(--text-base);
            transition: all var(--transition-fast);
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--color-primary-500);
            box-shadow: 0 0 0 3px var(--color-primary-100);
        }

        .form-textarea { resize: vertical; min-height: 100px; }

        .summary-card {
            background: var(--color-gray-50);
            border-radius: var(--radius-xl);
            padding: var(--space-5);
            margin-top: var(--space-4);
        }

        .summary-title {
            font-size: var(--text-base);
            font-weight: var(--font-semibold);
            color: var(--color-gray-900);
            margin-bottom: var(--space-4);
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: var(--space-2) 0;
            border-bottom: 1px solid var(--color-gray-200);
        }

        .summary-item:last-child { border-bottom: none; }

        .summary-label {
            font-size: var(--text-sm);
            color: var(--color-gray-500);
        }

        .summary-value {
            font-size: var(--text-sm);
            font-weight: var(--font-medium);
            color: var(--color-gray-900);
        }

        /* Actions */
        .booking-actions {
            display: flex;
            justify-content: space-between;
            padding: var(--space-4) var(--space-6);
            border-top: 1px solid var(--color-gray-200);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-lg);
            font-size: var(--text-base);
            font-weight: var(--font-medium);
            cursor: pointer;
            transition: all var(--transition-fast);
            border: none;
        }

        .btn svg { width: 20px; height: 20px; }

        .btn-primary {
            background: linear-gradient(135deg, var(--color-primary-600), var(--color-primary-700));
            color: white;
        }

        .btn-primary:hover { transform: translateY(-1px); box-shadow: var(--shadow-md); }

        .btn-secondary {
            background: white;
            color: var(--color-gray-700);
            border: 1px solid var(--color-gray-300);
        }

        .btn-secondary:hover { background: var(--color-gray-50); }

        @media (max-width: 768px) {
            .booking-steps { flex-direction: column; }
            .datetime-grid { grid-template-columns: 1fr; }
            .form-grid { grid-template-columns: 1fr; }
            .time-slots { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="booking-container">
        <div class="booking-header">
            <h1 class="booking-title">Book an Appointment</h1>
            <p class="booking-subtitle">Schedule a meeting with your tax professional</p>
        </div>

        <div class="booking-card">
            <div class="booking-steps">
                <div class="step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-title">Type</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-title">Date & Time</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-title">Confirm</div>
                </div>
            </div>

            <div class="booking-content">
                <!-- Step 1: Appointment Type -->
                <div class="step-content active" data-step="1">
                    <h3 class="section-title">Select Appointment Type</h3>
                    <div class="type-grid">
                        <div class="type-card" data-type="consultation" onclick="selectType(this)">
                            <div class="type-icon consultation">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                                </svg>
                            </div>
                            <div class="type-name">Initial Consultation</div>
                            <div class="type-duration">30 minutes</div>
                        </div>
                        <div class="type-card" data-type="review" onclick="selectType(this)">
                            <div class="type-icon review">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                            </div>
                            <div class="type-name">Return Review</div>
                            <div class="type-duration">45 minutes</div>
                        </div>
                        <div class="type-card" data-type="planning" onclick="selectType(this)">
                            <div class="type-icon planning">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                                </svg>
                            </div>
                            <div class="type-name">Tax Planning</div>
                            <div class="type-duration">60 minutes</div>
                        </div>
                        <div class="type-card" data-type="followup" onclick="selectType(this)">
                            <div class="type-icon followup">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                                </svg>
                            </div>
                            <div class="type-name">Follow-up Call</div>
                            <div class="type-duration">15 minutes</div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Date & Time -->
                <div class="step-content" data-step="2">
                    <div class="datetime-grid">
                        <div>
                            <h3 class="section-title">Select Date</h3>
                            <div class="date-grid" id="dateGrid">
                                <!-- Populated by JS -->
                            </div>
                        </div>
                        <div>
                            <h3 class="section-title">Available Times</h3>
                            <div class="time-slots" id="timeSlots">
                                <div class="time-slot" onclick="selectTime(this)">9:00 AM</div>
                                <div class="time-slot" onclick="selectTime(this)">9:30 AM</div>
                                <div class="time-slot" onclick="selectTime(this)">10:00 AM</div>
                                <div class="time-slot disabled">10:30 AM</div>
                                <div class="time-slot" onclick="selectTime(this)">11:00 AM</div>
                                <div class="time-slot" onclick="selectTime(this)">11:30 AM</div>
                                <div class="time-slot disabled">12:00 PM</div>
                                <div class="time-slot" onclick="selectTime(this)">1:00 PM</div>
                                <div class="time-slot" onclick="selectTime(this)">1:30 PM</div>
                                <div class="time-slot" onclick="selectTime(this)">2:00 PM</div>
                                <div class="time-slot" onclick="selectTime(this)">2:30 PM</div>
                                <div class="time-slot disabled">3:00 PM</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Confirmation -->
                <div class="step-content" data-step="3">
                    <h3 class="section-title">Your Information</h3>
                    <form id="bookingForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">First Name</label>
                                <input type="text" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Last Name</label>
                                <input type="text" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Phone</label>
                                <input type="tel" class="form-input">
                            </div>
                            <div class="form-group full-width">
                                <label class="form-label">Notes (Optional)</label>
                                <textarea class="form-textarea" placeholder="Any specific topics you'd like to discuss?"></textarea>
                            </div>
                        </div>
                    </form>

                    <div class="summary-card">
                        <h4 class="summary-title">Appointment Summary</h4>
                        <div class="summary-item">
                            <span class="summary-label">Type</span>
                            <span class="summary-value" id="summaryType">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Date</span>
                            <span class="summary-value" id="summaryDate">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Time</span>
                            <span class="summary-value" id="summaryTime">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Duration</span>
                            <span class="summary-value" id="summaryDuration">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="booking-actions">
                <button class="btn btn-secondary" id="prevBtn" onclick="prevStep()" style="visibility: hidden;">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    Back
                </button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextStep()">
                    Continue
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedType = null;
        let selectedDate = null;
        let selectedTime = null;

        const typeNames = {
            consultation: { name: 'Initial Consultation', duration: '30 minutes' },
            review: { name: 'Return Review', duration: '45 minutes' },
            planning: { name: 'Tax Planning', duration: '60 minutes' },
            followup: { name: 'Follow-up Call', duration: '15 minutes' }
        };

        function selectType(el) {
            document.querySelectorAll('.type-card').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
            selectedType = el.dataset.type;
        }

        function selectTime(el) {
            if (el.classList.contains('disabled')) return;
            document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
            el.classList.add('selected');
            selectedTime = el.textContent;
        }

        function selectDate(el) {
            if (el.classList.contains('disabled')) return;
            document.querySelectorAll('.date-cell').forEach(d => d.classList.remove('selected'));
            el.classList.add('selected');
            selectedDate = el.dataset.date;
        }

        function updateSteps() {
            document.querySelectorAll('.step').forEach(s => {
                const step = parseInt(s.dataset.step);
                s.classList.remove('active', 'completed');
                if (step === currentStep) s.classList.add('active');
                if (step < currentStep) s.classList.add('completed');
            });

            document.querySelectorAll('.step-content').forEach(c => {
                c.classList.remove('active');
                if (parseInt(c.dataset.step) === currentStep) c.classList.add('active');
            });

            document.getElementById('prevBtn').style.visibility = currentStep === 1 ? 'hidden' : 'visible';
            document.getElementById('nextBtn').textContent = currentStep === 3 ? 'Confirm Booking' : 'Continue';
        }

        function nextStep() {
            if (currentStep === 1 && !selectedType) {
                alert('Please select an appointment type');
                return;
            }
            if (currentStep === 2 && (!selectedDate || !selectedTime)) {
                alert('Please select a date and time');
                return;
            }
            if (currentStep === 3) {
                submitBooking();
                return;
            }

            currentStep++;
            updateSteps();
            updateSummary();
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateSteps();
            }
        }

        function updateSummary() {
            if (selectedType) {
                document.getElementById('summaryType').textContent = typeNames[selectedType].name;
                document.getElementById('summaryDuration').textContent = typeNames[selectedType].duration;
            }
            if (selectedDate) {
                document.getElementById('summaryDate').textContent = new Date(selectedDate).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });
            }
            if (selectedTime) {
                document.getElementById('summaryTime').textContent = selectedTime;
            }
        }

        function submitBooking() {
            alert('Appointment booked successfully!');
            window.location.href = '/appointments/calendar';
        }

        function renderDateGrid() {
            const grid = document.getElementById('dateGrid');
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth();

            ['S', 'M', 'T', 'W', 'T', 'F', 'S'].forEach(d => {
                const header = document.createElement('div');
                header.className = 'date-header';
                header.textContent = d;
                grid.appendChild(header);
            });

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            for (let i = 0; i < firstDay; i++) {
                const empty = document.createElement('div');
                empty.className = 'date-cell disabled';
                grid.appendChild(empty);
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('div');
                cell.className = 'date-cell';
                cell.textContent = day;
                cell.dataset.date = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;

                if (day < today.getDate()) {
                    cell.classList.add('disabled');
                } else if (day === today.getDate()) {
                    cell.classList.add('today');
                }

                cell.onclick = () => selectDate(cell);
                grid.appendChild(cell);
            }
        }

        renderDateGrid();
    </script>
</body>
</html>
