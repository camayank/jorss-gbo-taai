<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Tax Savings Analysis | {{ cpa.firm_name or cpa.display_name }}</title>
    <meta name="description" content="Discover how much you could save on taxes. Get a free personalized analysis from {{ cpa.display_name }}.">
    <meta name="robots" content="index, follow">
    {% if cpa.favicon_url %}
    <link rel="icon" href="{{ cpa.favicon_url }}">
    {% endif %}
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: {{ cpa.primary_color or '#2563eb' }};
            --secondary-color: {{ cpa.secondary_color or '#1d4ed8' }};
            --accent-color: {{ cpa.accent_color or '#10b981' }};
            --text-dark: #1f2937;
            --text-muted: #6b7280;
            --bg-light: #f9fafb;
            --white: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Trust Bar */
        .trust-bar {
            background: rgba(255, 255, 255, 0.95);
            padding: 12px 20px;
            border-radius: 12px;
            margin-bottom: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 24px;
            flex-wrap: wrap;
            font-size: 13px;
            color: #4a5568;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .trust-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .trust-icon {
            width: 18px;
            height: 18px;
        }

        .trust-icon.shield { color: #10b981; }
        .trust-icon.check { color: #3b82f6; }
        .trust-icon.lock { color: #8b5cf6; }

        /* Hero Card */
        .hero-card {
            background: var(--white);
            border-radius: 20px;
            padding: 50px 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        .cpa-branding {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            margin-bottom: 30px;
        }

        .cpa-logo {
            max-width: 60px;
            max-height: 60px;
            border-radius: 8px;
        }

        .cpa-info {
            text-align: left;
        }

        .cpa-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .cpa-firm {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .cpa-credentials {
            display: inline-flex;
            gap: 6px;
            margin-top: 4px;
        }

        .credential-badge {
            font-size: 0.7rem;
            padding: 2px 8px;
            background: var(--primary-color);
            color: white;
            border-radius: 10px;
            font-weight: 600;
        }

        /* Value Proposition */
        .value-prop {
            background: linear-gradient(135deg, var(--accent-color) 0%, #059669 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 16px;
            margin-bottom: 30px;
        }

        .value-amount {
            font-size: 2.5rem;
            font-weight: 700;
        }

        .value-text {
            font-size: 1rem;
            opacity: 0.95;
        }

        h1 {
            font-size: 2.2rem;
            margin-bottom: 16px;
            color: var(--text-dark);
            font-weight: 700;
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--text-muted);
            margin-bottom: 30px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Benefits Grid */
        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .benefit-item {
            text-align: center;
            padding: 20px 15px;
            background: var(--bg-light);
            border-radius: 12px;
        }

        .benefit-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .benefit-title {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 6px;
        }

        .benefit-desc {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        /* CTA Button */
        .cta-button {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 18px 50px;
            border-radius: 50px;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.4);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(37, 99, 235, 0.5);
        }

        .cta-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .cta-subtext {
            margin-top: 12px;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        /* Time Estimate */
        .time-estimate {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #fef3c7;
            color: #92400e;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 20px;
        }

        /* What You'll Get Section */
        .what-youll-get {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #e5e7eb;
        }

        .section-title {
            font-size: 1.1rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 20px;
        }

        .get-items {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            text-align: left;
        }

        .get-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 16px;
            background: var(--bg-light);
            border-radius: 12px;
        }

        .get-item-icon {
            flex-shrink: 0;
            width: 32px;
            height: 32px;
            background: var(--primary-color);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .get-item-text h4 {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .get-item-text p {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        /* Disclaimer */
        .disclaimer {
            margin-top: 30px;
            padding: 16px 20px;
            background: #f3f4f6;
            border-radius: 10px;
            font-size: 0.75rem;
            color: #6b7280;
            text-align: left;
            border-left: 3px solid #d1d5db;
        }

        .disclaimer strong {
            color: #374151;
        }

        /* Loading State */
        .loading {
            display: none;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .hero-card {
                padding: 30px 20px;
            }

            h1 {
                font-size: 1.7rem;
            }

            .subtitle {
                font-size: 1rem;
            }

            .benefits-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .trust-bar {
                flex-direction: column;
                gap: 10px;
                padding: 16px;
            }

            .get-items {
                grid-template-columns: 1fr;
            }

            .value-amount {
                font-size: 2rem;
            }

            .cta-button {
                padding: 16px 40px;
                font-size: 1.1rem;
            }

            .cpa-branding {
                flex-direction: column;
                text-align: center;
            }

            .cpa-info {
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Trust Bar -->
        <div class="trust-bar" role="banner" aria-label="Trust indicators">
            <div class="trust-item">
                <svg class="trust-icon shield" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                    <path d="M9 12l2 2 4-4"/>
                </svg>
                <span>Bank-Level Encryption</span>
            </div>
            <div class="trust-item">
                <svg class="trust-icon check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M9 12l2 2 4-4"/>
                </svg>
                <span>Licensed CPA</span>
            </div>
            <div class="trust-item">
                <svg class="trust-icon lock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                    <path d="M7 11V7a5 5 0 0110 0v4"/>
                </svg>
                <span>Your Data Never Sold</span>
            </div>
        </div>

        <!-- Hero Card -->
        <div class="hero-card">
            <!-- CPA Branding -->
            <div class="cpa-branding">
                {% if cpa.logo_url %}
                <img src="{{ cpa.logo_url }}" alt="{{ cpa.firm_name }}" class="cpa-logo">
                {% endif %}
                <div class="cpa-info">
                    <div class="cpa-name">{{ cpa.display_name }}</div>
                    {% if cpa.firm_name %}
                    <div class="cpa-firm">{{ cpa.firm_name }}</div>
                    {% endif %}
                    <div class="cpa-credentials">
                        {% for credential in cpa.credentials %}
                        <span class="credential-badge">{{ credential }}</span>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <!-- Value Proposition -->
            <div class="value-prop">
                <div class="value-amount">$2,847</div>
                <div class="value-text">Average tax savings identified for our clients</div>
            </div>

            <!-- Time Estimate -->
            <div class="time-estimate">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <polyline points="12 6 12 12 16 14"/>
                </svg>
                Just 3 quick questions (under 2 minutes)
            </div>

            <h1>Discover Your Hidden Tax Savings</h1>
            <p class="subtitle">
                Answer 3 simple questions and get a personalized analysis of potential
                deductions, credits, and tax-saving opportunities you might be missing.
            </p>

            <!-- Benefits Grid -->
            <div class="benefits-grid">
                <div class="benefit-item">
                    <div class="benefit-icon">ðŸ’°</div>
                    <div class="benefit-title">Find Hidden Savings</div>
                    <div class="benefit-desc">Identify deductions and credits you may have missed</div>
                </div>
                <div class="benefit-item">
                    <div class="benefit-icon">ðŸ“Š</div>
                    <div class="benefit-title">Personalized Insights</div>
                    <div class="benefit-desc">Get recommendations tailored to your situation</div>
                </div>
                <div class="benefit-item">
                    <div class="benefit-icon">ðŸŽ¯</div>
                    <div class="benefit-title">Expert Guidance</div>
                    <div class="benefit-desc">From a licensed CPA who knows tax law</div>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <div>Starting your analysis...</div>
            </div>

            <!-- CTA Button -->
            <button onclick="startAssessment()" class="cta-button" id="start-button">
                Get My Free Tax Analysis
            </button>
            <div class="cta-subtext">
                100% free. No credit card required.
            </div>

            <!-- What You'll Get -->
            <div class="what-youll-get">
                <div class="section-title">What You'll Get</div>
                <div class="get-items">
                    <div class="get-item">
                        <div class="get-item-icon">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/>
                                <polyline points="22 4 12 14.01 9 11.01"/>
                            </svg>
                        </div>
                        <div class="get-item-text">
                            <h4>Savings Estimate</h4>
                            <p>See how much you could potentially save</p>
                        </div>
                    </div>
                    <div class="get-item">
                        <div class="get-item-icon">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                                <polyline points="14 2 14 8 20 8"/>
                            </svg>
                        </div>
                        <div class="get-item-text">
                            <h4>Tax Insights Report</h4>
                            <p>Personalized recommendations for your situation</p>
                        </div>
                    </div>
                    <div class="get-item">
                        <div class="get-item-icon">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/>
                            </svg>
                        </div>
                        <div class="get-item-text">
                            <h4>Free Consultation Option</h4>
                            <p>Speak with a CPA about your specific needs</p>
                        </div>
                    </div>
                    <div class="get-item">
                        <div class="get-item-icon">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                <line x1="16" y1="2" x2="16" y2="6"/>
                                <line x1="8" y1="2" x2="8" y2="6"/>
                                <line x1="3" y1="10" x2="21" y2="10"/>
                            </svg>
                        </div>
                        <div class="get-item-text">
                            <h4>Tax Calendar Reminders</h4>
                            <p>Key dates you need to know</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Disclaimer -->
            <div class="disclaimer">
                <strong>Important Disclosure:</strong> This analysis tool provides educational
                information about potential tax-saving opportunities based on general tax principles.
                The estimates provided are for informational purposes only and do not constitute
                tax advice. Actual savings depend on your complete financial situation and may vary.
                For personalized tax advice, please consult with {{ cpa.display_name }} or a
                qualified tax professional. By proceeding, you agree to our
                <a href="/privacy" target="_blank">Privacy Policy</a> and
                <a href="/terms" target="_blank">Terms of Service</a>.
            </div>
        </div>
    </div>

    <script>
        // Get CPA slug from URL or use default
        const urlParams = new URLSearchParams(window.location.search);
        const cpaSlug = urlParams.get('cpa') || '{{ cpa.cpa_slug }}';

        async function startAssessment() {
            const button = document.getElementById('start-button');
            const loading = document.getElementById('loading');

            try {
                // Disable button and show loading
                button.disabled = true;
                button.style.opacity = '0.6';
                loading.classList.add('show');

                // Start assessment session
                const response = await fetch('/api/cpa/lead-magnet/start', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        cpa_slug: cpaSlug,
                        assessment_mode: 'quick',
                        referral_source: urlParams.get('ref') || document.referrer || 'direct'
                    })
                });

                if (!response.ok) {
                    throw new Error('Failed to start assessment');
                }

                const data = await response.json();

                // Store session ID
                sessionStorage.setItem('assessment_session_id', data.session_id);
                sessionStorage.setItem('cpa_profile', JSON.stringify(data.cpa_profile));

                // Redirect to quick estimate form
                window.location.href = `/lead-magnet/estimate?session=${data.session_id}`;

            } catch (error) {
                console.error('Failed to start assessment:', error);
                alert('Unable to start assessment. Please try again.');

                // Re-enable button
                button.disabled = false;
                button.style.opacity = '1';
                loading.classList.remove('show');
            }
        }

        // Track page view for analytics
        document.addEventListener('DOMContentLoaded', function() {
            // Could send analytics event here
            console.log('Lead magnet landing page loaded for CPA:', cpaSlug);
        });
    </script>
</body>
</html>
